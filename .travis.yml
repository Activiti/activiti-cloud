language: java 
sudo: required
cache:
  directories:
  - $HOME/.m2
services:
  - docker
jdk:
  - openjdk11
notifications:
  webhooks:
    urls:
      - https://webhooks.gitter.im/e/4eabeeadee998a77068b
    on_success: change  # options: [always|never|change] default: always
    on_failure: always  # options: [always|never|change] default: always
    on_start: never     # options: [always|never|change] default: always
  slack:
    script:
      - 'if [ "$TRAVIS_PULL_REQUEST" != "false" ]; then exit -1;  fi'
    if: branch = develop    
    rooms:
        secure: "BsI1ZeRxPE5hamNU/R20GZd2kLC2VkoJd9cIDSM1SkMRd9EFBPiptC8x3hXcdYCDWz4XhTlkmoIHaKexRyOvH5EZoOi1CGeftF9gATMhEOyY/EzU2z4GNQNp1g2386D5RVNvRolTRY+niJDlyi7h0pTqXjJcYKN4JniAkstl2kVXUXqj+nfwpmrVL5RMqOfXkeZDAc+xzZezm6i5PApR0BAclemDiS0poFdJhG79IRxdkF8xya5Bhev3+huegeAxD87+LuhjYFwuLHnjbH9bRSdCodoQOfQxspFy1/SqL/wWgYqAkTifXqmKZjXRxTRkkCz8pqggM/AiTaEPk1lU3IkpEnM3wK8x7YivuXJJ0mCSuVfjtbqstLENC0x7ua1N0hfq0x4oHDGCS1tGoqwFt7YRN43mVHvwbAvLEfc6SqWztx3YlNtedhWJ2EOifPRmHokjBoAv4lSTafx4hsVkomTgGW+PDCmXMfqgrRjytvJqQhgipKLayekunv0P0kX5FCiBzsZSlcIzMeFLFBtbYUeY0Lh3rch+ArcZ7YXmzneaoothpXTgrb99hmkJd21HzfXtbYXwOAErizHlHtw/nOeAf5rc+166WRXZFaQieO0qp0vCMjXTh6OlrqqtqkqfZIXqFo9Sbqa0rz35riRkDJXdM3VLDitSI0vNns9upqY="   
    on_failure: always
    on_success: change
    template:
      - "Repo `%{repository_slug}` *%{result}* build (<%{build_url}|#%{build_number}>) for commit (<%{compare_url}|%{commit}>) on branch `%{branch}`."
      - "Author: %{author} Execution time: *%{duration}*"
      - "Message: %{message}"  
before_script:
  - echo MAVEN_OPTS=-Xmx1536m > ~/.mavenrc

# Enable integration tests
script:
  - mvn verify -B -DskipITs=false

# Send coverage data
after_success:
  bash <(curl -s https://codecov.io/bash)

after_failure:
  - cat **/target/surefire-reports/*.xml | grep -B 1 -A 10 "<error"
  - cat **/target/failsafe-reports/*.xml | grep -B 1 -A 10 "<error"

env:
  global:
  - DOCKER_HOST=tcp://127.0.0.1:2375
